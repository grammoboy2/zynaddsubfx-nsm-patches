From 7269c1894ec9ac7c7118d088d97f504b6caea668 Mon Sep 17 00:00:00 2001
From: fundamental <mark.d.mccurry@gmail.com>
Date: Sun, 5 Apr 2015 16:02:21 -0400
Subject: [PATCH 0407/1936] main: Add Bare Bones Fix For -U

---
 src/UI/Connection.cpp | 2 ++
 src/main.cpp          | 4 +++-
 2 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/UI/Connection.cpp b/src/UI/Connection.cpp
index d233e425..6c8ce3a6 100644
--- a/src/UI/Connection.cpp
+++ b/src/UI/Connection.cpp
@@ -172,6 +172,8 @@ static rtosc::Ports ports = {
 
 void GUI::raiseUi(ui_handle_t gui, const char *message)
 {
+    if(!gui)
+        return;
     MasterUI *mui = (MasterUI*)gui;
     mui->osc->tryLink(message);
     //printf("got message for UI '%s'\n", message);
diff --git a/src/main.cpp b/src/main.cpp
index e92d1525..66d06f09 100644
--- a/src/main.cpp
+++ b/src/main.cpp
@@ -432,7 +432,9 @@ int main(int argc, char *argv[])
     }
 
 
-    gui = GUI::createUi(middleware->spawnUiApi(), &Pexitprogram);
+    gui = NULL;
+    if(!noui)
+        gui = GUI::createUi(middleware->spawnUiApi(), &Pexitprogram);
     middleware->setUiCallback(GUI::raiseUi, gui);
     middleware->setIdleCallback([](){GUI::tickUi(gui);});
     middlewarepointer = middleware;
-- 
2.47.0

