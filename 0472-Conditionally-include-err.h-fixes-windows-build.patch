From a55b06306ad968f5311116709e36fb956d9c1062 Mon Sep 17 00:00:00 2001
From: falkTX <falktx@gmail.com>
Date: Tue, 26 May 2015 10:08:11 +0200
Subject: [PATCH 0472/1936] Conditionally include err.h, fixes windows build

---
 src/DSP/SVFilter.cpp    | 5 ++++-
 src/DSP/Unison.cpp      | 5 ++++-
 src/Misc/MiddleWare.cpp | 2 ++
 src/Misc/Util.cpp       | 4 +++-
 4 files changed, 13 insertions(+), 3 deletions(-)

diff --git a/src/DSP/SVFilter.cpp b/src/DSP/SVFilter.cpp
index 3d198aad..cc78d378 100644
--- a/src/DSP/SVFilter.cpp
+++ b/src/DSP/SVFilter.cpp
@@ -24,10 +24,13 @@
 #include <cstdio>
 #include <cstring>
 #include <cassert>
-#include <err.h>
 #include "../Misc/Util.h"
 #include "SVFilter.h"
 
+#ifndef errx
+#include <err.h>
+#endif
+
 SVFilter::SVFilter(unsigned char Ftype, float Ffreq, float Fq,
                    unsigned char Fstages, unsigned int srate, int bufsize)
     :Filter(srate, bufsize),
diff --git a/src/DSP/Unison.cpp b/src/DSP/Unison.cpp
index f51bdb38..c7518c49 100644
--- a/src/DSP/Unison.cpp
+++ b/src/DSP/Unison.cpp
@@ -21,11 +21,14 @@
 
 #include <cmath>
 #include <cstring>
-#include <err.h>
 
 #include "../Misc/Allocator.h"
 #include "Unison.h"
 
+#ifndef errx
+#include <err.h>
+#endif
+
 Unison::Unison(Allocator *alloc_, int update_period_samples_, float max_delay_sec_, float srate_f)
     :unison_size(0),
       base_freq(1.0f),
diff --git a/src/Misc/MiddleWare.cpp b/src/Misc/MiddleWare.cpp
index b5c9d83a..301745b2 100644
--- a/src/Misc/MiddleWare.cpp
+++ b/src/Misc/MiddleWare.cpp
@@ -34,7 +34,9 @@
 #include <atomic>
 #include <list>
 
+#ifndef errx
 #include <err.h>
+#endif
 
 using std::string;
 #ifndef PLUGINVERSION
diff --git a/src/Misc/Util.cpp b/src/Misc/Util.cpp
index 2ff0f1b6..54acfe81 100644
--- a/src/Misc/Util.cpp
+++ b/src/Misc/Util.cpp
@@ -26,7 +26,6 @@
 #include <cmath>
 #include <cstdio>
 #include <fstream>
-#include <err.h>
 
 #include <sys/types.h>
 #include <sys/stat.h>
@@ -38,6 +37,9 @@
 #include <sched.h>
 #endif
 
+#ifndef errx
+#include <err.h>
+#endif
 
 prng_t prng_state = 0x1234;
 
-- 
2.47.0

