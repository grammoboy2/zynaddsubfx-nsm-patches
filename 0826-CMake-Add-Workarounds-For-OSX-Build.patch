From 7aab8e015ed301a8830eec7c05748b7e3b992621 Mon Sep 17 00:00:00 2001
From: fundamental <mark.d.mccurry@gmail.com>
Date: Sat, 16 Jan 2016 13:24:39 -0500
Subject: [PATCH 0826/1936] CMake: Add Workarounds For OSX Build

---
 src/CMakeLists.txt                      | 6 ++++--
 src/Plugin/AlienWah/CMakeLists.txt      | 2 +-
 src/Plugin/Chorus/CMakeLists.txt        | 2 +-
 src/Plugin/Distortion/CMakeLists.txt    | 2 +-
 src/Plugin/DynamicFilter/CMakeLists.txt | 2 +-
 src/Plugin/Echo/CMakeLists.txt          | 2 +-
 src/Plugin/Phaser/CMakeLists.txt        | 2 +-
 src/Plugin/Reverb/CMakeLists.txt        | 2 +-
 src/Plugin/ZynAddSubFX/CMakeLists.txt   | 2 +-
 9 files changed, 12 insertions(+), 10 deletions(-)

diff --git a/src/CMakeLists.txt b/src/CMakeLists.txt
index e9517e5e..1dfcf693 100644
--- a/src/CMakeLists.txt
+++ b/src/CMakeLists.txt
@@ -80,6 +80,8 @@ SET (DssiEnable ${DSSI_FOUND} CACHE BOOL
     "Enable DSSI Plugin compilation")
 SET (LibloEnable ${LIBLO_FOUND} CACHE BOOL
     "Enable Liblo")
+SET (NoNeonPlease False CACHE BOOL
+    "Workaround For Broken Neon Detection")
 
 # Now, handle the incoming settings and set define flags/variables based
 # on this
@@ -265,9 +267,9 @@ else (BuildForDebug)
 		set (CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} ${BuildOptions_SSE}")
 	endif (SUPPORT_SSE)
 	
-	if (SUPPORT_NEON)
+    if (SUPPORT_NEON AND NOT NoNeonPlease)
 		set (CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} ${BuildOptions_NEON}")
-	endif (SUPPORT_NEON)
+	endif (SUPPORT_NEON AND NOT NoNeonPlease)
 	
 	message (STATUS "Building for ${CMAKE_BUILD_TYPE}, flags: ${CMAKE_CXX_FLAGS_RELEASE}")
 endif (BuildForDebug)
diff --git a/src/Plugin/AlienWah/CMakeLists.txt b/src/Plugin/AlienWah/CMakeLists.txt
index 9479585c..5aed698f 100644
--- a/src/Plugin/AlienWah/CMakeLists.txt
+++ b/src/Plugin/AlienWah/CMakeLists.txt
@@ -21,7 +21,7 @@ install(TARGETS ZynAlienWah_lv2 LIBRARY DESTINATION lib/lv2/ZynAlienWah.lv2/)
 install(TARGETS ZynAlienWah_vst LIBRARY DESTINATION lib/vst/)
 
 add_custom_command(TARGET ZynAlienWah_lv2 POST_BUILD
-	COMMAND lv2-ttl-generator ./ZynAlienWah.so
+    COMMAND lv2-ttl-generator $<TARGET_FILE:ZynAlienWah_lv2>
 	WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/lv2)
 
 install(FILES
diff --git a/src/Plugin/Chorus/CMakeLists.txt b/src/Plugin/Chorus/CMakeLists.txt
index 49ccfcbe..17b4da06 100644
--- a/src/Plugin/Chorus/CMakeLists.txt
+++ b/src/Plugin/Chorus/CMakeLists.txt
@@ -21,7 +21,7 @@ install(TARGETS ZynChorus_lv2 LIBRARY DESTINATION lib/lv2/ZynChorus.lv2/)
 install(TARGETS ZynChorus_vst LIBRARY DESTINATION lib/vst/)
 
 add_custom_command(TARGET ZynChorus_lv2 POST_BUILD
-	COMMAND lv2-ttl-generator ./ZynChorus.so
+    COMMAND lv2-ttl-generator $<TARGET_FILE:ZynChorus_lv2>
 	WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/lv2)
 
 install(FILES
diff --git a/src/Plugin/Distortion/CMakeLists.txt b/src/Plugin/Distortion/CMakeLists.txt
index e99c05e1..1546b3e5 100644
--- a/src/Plugin/Distortion/CMakeLists.txt
+++ b/src/Plugin/Distortion/CMakeLists.txt
@@ -21,7 +21,7 @@ install(TARGETS ZynDistortion_lv2 LIBRARY DESTINATION lib/lv2/ZynDistortion.lv2/
 install(TARGETS ZynDistortion_vst LIBRARY DESTINATION lib/vst/)
 
 add_custom_command(TARGET ZynDistortion_lv2 POST_BUILD
-	COMMAND lv2-ttl-generator ./ZynDistortion.so
+    COMMAND lv2-ttl-generator $<TARGET_FILE:ZynDistortion_lv2>
 	WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/lv2)
 
 install(FILES
diff --git a/src/Plugin/DynamicFilter/CMakeLists.txt b/src/Plugin/DynamicFilter/CMakeLists.txt
index 5c6a597b..47aed84c 100644
--- a/src/Plugin/DynamicFilter/CMakeLists.txt
+++ b/src/Plugin/DynamicFilter/CMakeLists.txt
@@ -21,7 +21,7 @@ install(TARGETS ZynDynamicFilter_lv2 LIBRARY DESTINATION lib/lv2/ZynDynamicFilte
 install(TARGETS ZynDynamicFilter_vst LIBRARY DESTINATION lib/vst/)
 
 add_custom_command(TARGET ZynDynamicFilter_lv2 POST_BUILD
-	COMMAND lv2-ttl-generator ./ZynDynamicFilter.so
+    COMMAND lv2-ttl-generator $<TARGET_FILE:ZynDynamicFilter_lv2>
 	WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/lv2)
 
 install(FILES
diff --git a/src/Plugin/Echo/CMakeLists.txt b/src/Plugin/Echo/CMakeLists.txt
index b83f23d1..d93b5541 100644
--- a/src/Plugin/Echo/CMakeLists.txt
+++ b/src/Plugin/Echo/CMakeLists.txt
@@ -21,7 +21,7 @@ install(TARGETS ZynEcho_lv2 LIBRARY DESTINATION lib/lv2/ZynEcho.lv2/)
 install(TARGETS ZynEcho_vst LIBRARY DESTINATION lib/vst/)
 
 add_custom_command(TARGET ZynEcho_lv2 POST_BUILD
-	COMMAND lv2-ttl-generator ./ZynEcho.so
+    COMMAND lv2-ttl-generator $<TARGET_FILE:ZynEcho_lv2>
 	WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/lv2)
 
 install(FILES
diff --git a/src/Plugin/Phaser/CMakeLists.txt b/src/Plugin/Phaser/CMakeLists.txt
index 09f91c4b..eaa2f077 100644
--- a/src/Plugin/Phaser/CMakeLists.txt
+++ b/src/Plugin/Phaser/CMakeLists.txt
@@ -21,7 +21,7 @@ install(TARGETS ZynPhaser_lv2 LIBRARY DESTINATION lib/lv2/ZynPhaser.lv2/)
 install(TARGETS ZynPhaser_vst LIBRARY DESTINATION lib/vst/)
 
 add_custom_command(TARGET ZynPhaser_lv2 POST_BUILD
-	COMMAND lv2-ttl-generator ./ZynPhaser.so
+    COMMAND lv2-ttl-generator $<TARGET_FILE:ZynPhaser_lv2>
 	WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/lv2)
 
 install(FILES
diff --git a/src/Plugin/Reverb/CMakeLists.txt b/src/Plugin/Reverb/CMakeLists.txt
index 291f96f4..58aa25e7 100644
--- a/src/Plugin/Reverb/CMakeLists.txt
+++ b/src/Plugin/Reverb/CMakeLists.txt
@@ -21,7 +21,7 @@ install(TARGETS ZynReverb_lv2 LIBRARY DESTINATION lib/lv2/ZynReverb.lv2/)
 install(TARGETS ZynReverb_vst LIBRARY DESTINATION lib/vst/)
 
 add_custom_command(TARGET ZynReverb_lv2 POST_BUILD
-	COMMAND lv2-ttl-generator ./ZynReverb.so
+    COMMAND lv2-ttl-generator $<TARGET_FILE:ZynReverb_lv2>
 	WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/lv2)
 
 install(FILES
diff --git a/src/Plugin/ZynAddSubFX/CMakeLists.txt b/src/Plugin/ZynAddSubFX/CMakeLists.txt
index 8cb6b7ac..111bdb3e 100644
--- a/src/Plugin/ZynAddSubFX/CMakeLists.txt
+++ b/src/Plugin/ZynAddSubFX/CMakeLists.txt
@@ -56,7 +56,7 @@ install(TARGETS ZynAddSubFX_lv2 LIBRARY DESTINATION lib/lv2/ZynAddSubFX.lv2/)
 install(TARGETS ZynAddSubFX_vst LIBRARY DESTINATION lib/vst/)
 
 add_custom_command(TARGET ZynAddSubFX_lv2 POST_BUILD
-	COMMAND lv2-ttl-generator ./ZynAddSubFX.so
+    COMMAND lv2-ttl-generator $<TARGET_FILE:ZynAddSubFX_lv2>
 	WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/lv2)
 
 install(FILES
-- 
2.47.0

