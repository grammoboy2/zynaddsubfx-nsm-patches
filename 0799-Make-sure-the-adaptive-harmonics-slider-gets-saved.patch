From 07e3b47f89a04e3f9cd99673fc8b12fecd07a652 Mon Sep 17 00:00:00 2001
From: "Christopher A. Oliver" <caowasteland@gmail.com>
Date: Fri, 18 Dec 2015 07:48:02 -0500
Subject: [PATCH 0799/1936] Make sure the adaptive harmonics slider gets saved.
 I thought this got pushed a while back. /me boggles

---
 src/Synth/OscilGen.cpp      | 5 +++++
 src/Tests/guitar-adnote.xmz | 6 ++++++
 2 files changed, 11 insertions(+)

diff --git a/src/Synth/OscilGen.cpp b/src/Synth/OscilGen.cpp
index ecc9a670..9b6751ac 100644
--- a/src/Synth/OscilGen.cpp
+++ b/src/Synth/OscilGen.cpp
@@ -1265,6 +1265,7 @@ void OscilGen::add2XML(XMLwrapper& xml)
     xml.addpar("adaptive_harmonics", Padaptiveharmonics);
     xml.addpar("adaptive_harmonics_base_frequency", Padaptiveharmonicsbasefreq);
     xml.addpar("adaptive_harmonics_power", Padaptiveharmonicspower);
+    xml.addpar("adaptive_harmonics_par", Padaptiveharmonicspar);
 
     xml.beginbranch("HARMONICS");
     for(int n = 0; n < MAX_AD_HARMONICS; ++n) {
@@ -1356,6 +1357,10 @@ void OscilGen::getfromXML(XMLwrapper& xml)
                                           Padaptiveharmonicspower,
                                           0,
                                           200);
+    Padaptiveharmonicspar = xml.getpar("adaptive_harmonics_par",
+                                       Padaptiveharmonicspar,
+                                       0,
+                                       100);
 
 
     if(xml.enterbranch("HARMONICS")) {
diff --git a/src/Tests/guitar-adnote.xmz b/src/Tests/guitar-adnote.xmz
index 29361dd2..20092530 100644
--- a/src/Tests/guitar-adnote.xmz
+++ b/src/Tests/guitar-adnote.xmz
@@ -220,6 +220,7 @@ version-revision="2" ZynAddSubFX-author="Nasca Octavian Paul">
 <par name="adaptive_harmonics" value="0" />
 <par name="adaptive_harmonics_base_frequency" value="128" />
 <par name="adaptive_harmonics_power" value="100" />
+<par name="adaptive_harmonics_par" value="50" />
 <HARMONICS>
 <HARMONIC id="1">
 <par name="mag" value="74" />
@@ -413,6 +414,7 @@ version-revision="2" ZynAddSubFX-author="Nasca Octavian Paul">
 <par name="adaptive_harmonics" value="0" />
 <par name="adaptive_harmonics_base_frequency" value="128" />
 <par name="adaptive_harmonics_power" value="100" />
+<par name="adaptive_harmonics_par" value="50" />
 <HARMONICS>
 <HARMONIC id="1">
 <par name="mag" value="127" />
@@ -470,6 +472,7 @@ version-revision="2" ZynAddSubFX-author="Nasca Octavian Paul">
 <par name="adaptive_harmonics" value="0" />
 <par name="adaptive_harmonics_base_frequency" value="128" />
 <par name="adaptive_harmonics_power" value="100" />
+<par name="adaptive_harmonics_par" value="50" />
 <HARMONICS>
 <HARMONIC id="1">
 <par name="mag" value="127" />
@@ -555,6 +558,7 @@ version-revision="2" ZynAddSubFX-author="Nasca Octavian Paul">
 <par name="adaptive_harmonics" value="0" />
 <par name="adaptive_harmonics_base_frequency" value="128" />
 <par name="adaptive_harmonics_power" value="100" />
+<par name="adaptive_harmonics_par" value="50" />
 <HARMONICS>
 <HARMONIC id="1">
 <par name="mag" value="127" />
@@ -640,6 +644,7 @@ version-revision="2" ZynAddSubFX-author="Nasca Octavian Paul">
 <par name="adaptive_harmonics" value="0" />
 <par name="adaptive_harmonics_base_frequency" value="128" />
 <par name="adaptive_harmonics_power" value="100" />
+<par name="adaptive_harmonics_par" value="50" />
 <HARMONICS>
 <HARMONIC id="2">
 <par name="mag" value="127" />
@@ -1260,6 +1265,7 @@ version-revision="2" ZynAddSubFX-author="Nasca Octavian Paul">
 <par name="adaptive_harmonics" value="0" />
 <par name="adaptive_harmonics_base_frequency" value="128" />
 <par name="adaptive_harmonics_power" value="100" />
+<par name="adaptive_harmonics_par" value="50" />
 <HARMONICS>
 <HARMONIC id="1">
 <par name="mag" value="127" />
-- 
2.47.0

