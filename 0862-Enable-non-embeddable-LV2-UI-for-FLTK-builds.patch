From 0de12993319d3ac1034073830d099c5a1330936b Mon Sep 17 00:00:00 2001
From: falkTX <falktx@gmail.com>
Date: Sun, 14 Feb 2016 21:11:06 +0100
Subject: [PATCH 0862/1936] Enable non-embeddable LV2 UI for FLTK builds

---
 src/Plugin/ZynAddSubFX/CMakeLists.txt      | 22 +++++++++++++++++++++-
 src/Plugin/ZynAddSubFX/DistrhoPluginInfo.h |  6 +++++-
 2 files changed, 26 insertions(+), 2 deletions(-)

diff --git a/src/Plugin/ZynAddSubFX/CMakeLists.txt b/src/Plugin/ZynAddSubFX/CMakeLists.txt
index 648ff235..9ad401b6 100644
--- a/src/Plugin/ZynAddSubFX/CMakeLists.txt
+++ b/src/Plugin/ZynAddSubFX/CMakeLists.txt
@@ -3,7 +3,7 @@ include_directories(${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_SOURCE_DIR}/DPF/distrho
 
 if(NtkGui)
 
-# UI Enabled
+# UI Enabled using NTK: embed + external
 add_library(ZynAddSubFX_lv2 SHARED
     ${CMAKE_SOURCE_DIR}/src/globals.cpp
     ${CMAKE_SOURCE_DIR}/src/UI/ConnectionDummy.cpp
@@ -22,6 +22,26 @@ add_library(ZynAddSubFX_vst SHARED
     ZynAddSubFX.cpp
     ZynAddSubFX-UI.cpp)
 
+# TODO: Make this also check for Linux or MacOS
+elseif(FltkGui)
+
+# UI Enabled using FLTK: external only
+add_library(ZynAddSubFX_lv2 SHARED
+    ${CMAKE_SOURCE_DIR}/src/globals.cpp
+    ${CMAKE_SOURCE_DIR}/src/UI/ConnectionDummy.cpp
+    ${CMAKE_SOURCE_DIR}/DPF/distrho/DistrhoPluginMain.cpp
+    ZynAddSubFX.cpp)
+
+add_library(ZynAddSubFX_lv2_ui SHARED
+    ${CMAKE_SOURCE_DIR}/DPF/distrho/DistrhoUIMain.cpp
+    ZynAddSubFX-UI.cpp)
+
+add_library(ZynAddSubFX_vst SHARED
+    ${CMAKE_SOURCE_DIR}/src/globals.cpp
+    ${CMAKE_SOURCE_DIR}/src/UI/ConnectionDummy.cpp
+    ${CMAKE_SOURCE_DIR}/DPF/distrho/DistrhoPluginMain.cpp
+    ZynAddSubFX.cpp)
+
 else()
 
 # UI Disabled
diff --git a/src/Plugin/ZynAddSubFX/DistrhoPluginInfo.h b/src/Plugin/ZynAddSubFX/DistrhoPluginInfo.h
index 93713ebe..7caaf8b8 100644
--- a/src/Plugin/ZynAddSubFX/DistrhoPluginInfo.h
+++ b/src/Plugin/ZynAddSubFX/DistrhoPluginInfo.h
@@ -27,10 +27,14 @@
 #define DISTRHO_PLUGIN_NAME  "ZynAddSubFX"
 #define DISTRHO_PLUGIN_URI   "http://zynaddsubfx.sourceforge.net"
 
-#ifdef NTK_GUI
+#if defined(NTK_GUI)
  #define DISTRHO_PLUGIN_HAS_UI          1
  #define DISTRHO_PLUGIN_HAS_EMBED_UI    1
  #define DISTRHO_PLUGIN_HAS_EXTERNAL_UI 1
+#elif defined(FLTK_GUI)
+ #define DISTRHO_PLUGIN_HAS_UI          1
+ #define DISTRHO_PLUGIN_HAS_EMBED_UI    0
+ #define DISTRHO_PLUGIN_HAS_EXTERNAL_UI 1
 #else
  #define DISTRHO_PLUGIN_HAS_UI          0
 #endif
-- 
2.47.0

