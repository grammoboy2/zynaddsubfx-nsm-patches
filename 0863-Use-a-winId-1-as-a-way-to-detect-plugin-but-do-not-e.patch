From 012e48f2be51321d791c2450c725b9895f83e7e5 Mon Sep 17 00:00:00 2001
From: falkTX <falktx@gmail.com>
Date: Sun, 14 Feb 2016 21:21:30 +0100
Subject: [PATCH 0863/1936] Use a winId '1' as a way to detect plugin, but do
 not embed

---
 DPF                                       |  2 +-
 src/Plugin/ZynAddSubFX/ZynAddSubFX-UI.cpp |  2 +-
 src/UI/guimain.cpp                        | 11 ++++++++---
 3 files changed, 10 insertions(+), 5 deletions(-)

diff --git a/DPF b/DPF
index 502d3359..720d681a 160000
--- a/DPF
+++ b/DPF
@@ -1 +1 @@
-Subproject commit 502d3359fbe230cdf9030b81228e945e5a7060d3
+Subproject commit 720d681a09bd8bef418b0e12a65679a7905699d8
diff --git a/src/Plugin/ZynAddSubFX/ZynAddSubFX-UI.cpp b/src/Plugin/ZynAddSubFX/ZynAddSubFX-UI.cpp
index 486d95a7..30bf8dd9 100644
--- a/src/Plugin/ZynAddSubFX/ZynAddSubFX-UI.cpp
+++ b/src/Plugin/ZynAddSubFX/ZynAddSubFX-UI.cpp
@@ -90,7 +90,7 @@ private:
         sprintf(urlAsString, "osc.udp://localhost:%i/", url);
 
         char winIdAsString[32];
-        sprintf(winIdAsString, "%llu", (long long unsigned)winId);
+        sprintf(winIdAsString, "%llu", (long long unsigned)(winId ? winId : 1));
 
         printf("Now respawning at '%s', using winId '%s'\n", urlAsString, winIdAsString);
 
diff --git a/src/UI/guimain.cpp b/src/UI/guimain.cpp
index d6579c39..85a3a73c 100644
--- a/src/UI/guimain.cpp
+++ b/src/UI/guimain.cpp
@@ -198,12 +198,17 @@ ui_handle_t GUI::createUi(Fl_Osc_Interface *osc, void *exit)
     {
         if (long long winId = atoll(embedId))
         {
-            // running embed as plugin
+            // running as plugin
             isPlugin = true;
             MasterUI::menu_mastermenu[11].hide(); // file -> nio settings
-            MasterUI::menu_mastermenu[13].hide(); // file -> exit
             MasterUI::menu_mastermenu[26].deactivate(); // misc -> switch interface mode
-            fl_embed(ui->masterwindow, winId);
+
+            if (winId != 1)
+            {
+                MasterUI::menu_mastermenu[13].hide(); // file -> exit
+                fl_embed(ui->masterwindow, winId);
+            }
+
             ui->masterwindow->show();
         }
     }
-- 
2.47.0

