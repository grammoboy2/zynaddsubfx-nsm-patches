From 91071fa392611bddc78cf8fa338856490cc26411 Mon Sep 17 00:00:00 2001
From: fundamental <mark.d.mccurry@gmail.com>
Date: Sat, 10 Oct 2015 11:37:30 -0400
Subject: [PATCH 0584/1936] Tweak UI Title Rewrite

---
 src/Misc/MiddleWare.cpp |  2 ++
 src/UI/Fl_Osc_Pane.cpp  | 18 ++++++++++++++++--
 2 files changed, 18 insertions(+), 2 deletions(-)

diff --git a/src/Misc/MiddleWare.cpp b/src/Misc/MiddleWare.cpp
index 91ce56f5..1e9e8495 100644
--- a/src/Misc/MiddleWare.cpp
+++ b/src/Misc/MiddleWare.cpp
@@ -1243,6 +1243,8 @@ void MiddleWareImpl::handleMsg(const char *msg)
         undo.seekHistory(-1);
     } else if(!strcmp(msg, "/redo")) {
         undo.seekHistory(+1);
+    } else if(!strcmp(msg, "/ui/title")) {
+        ;//drop the message into the abyss
     } else
         uToB->raw_write(msg);
 }
diff --git a/src/UI/Fl_Osc_Pane.cpp b/src/UI/Fl_Osc_Pane.cpp
index 1b93f6fa..012d3cef 100644
--- a/src/UI/Fl_Osc_Pane.cpp
+++ b/src/UI/Fl_Osc_Pane.cpp
@@ -11,13 +11,27 @@ Fl_Osc_Pane::Fl_Osc_Pane(void)
 Fl_Osc_Window::Fl_Osc_Window(int w, int h, const char *L)
     :Fl_Double_Window(w,h,L), title_ext(NULL)
 {}
-        
+
 void Fl_Osc_Window::init(Fl_Osc_Interface *osc_, std::string loc_)
 {
     title_ext  = new Osc_DataModel(osc_);
     title_ext->doUpdate("/ui/title");
     title_ext->callback = [this](string next) {
-        title_new = title_orig + next;
+        //printf("old: %s\n", title_orig.c_str());
+        const char *orig = title_orig.c_str();
+        //                               12345678901
+        const char *sub  = strstr(orig, "zynaddsubfx");
+        if(!sub)
+            sub  = strstr(orig, "ZynAddSubFX");
+        title_new = "";
+        while(*orig) {
+            if(orig == sub) {
+                title_new += next;
+                orig += 11;
+            } else
+                title_new += *orig++;
+        }
+        //title_new = title_orig + next;
         this->label(title_new.c_str());
     };
     title_orig = label();
-- 
2.47.0

