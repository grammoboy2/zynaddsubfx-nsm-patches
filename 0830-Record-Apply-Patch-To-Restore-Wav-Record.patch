From 08d6c92459d91f95cd1bab24a3ae4d99884000e6 Mon Sep 17 00:00:00 2001
From: fundamental <mark.d.mccurry@gmail.com>
Date: Fri, 22 Jan 2016 17:10:01 -0500
Subject: [PATCH 0830/1936] Record: Apply Patch To Restore Wav Record

Patch By Simon Kilvington
---
 src/Misc/Master.cpp | 13 +++++++++++++
 src/UI/MasterUI.fl  |  4 ++--
 2 files changed, 15 insertions(+), 2 deletions(-)

diff --git a/src/Misc/Master.cpp b/src/Misc/Master.cpp
index 40f328ff..ff152e5c 100644
--- a/src/Misc/Master.cpp
+++ b/src/Misc/Master.cpp
@@ -237,6 +237,19 @@ static const Ports master_ports = {
         SNIP
             preset_ports.dispatch(msg, data);
         rBOIL_END},
+    {"HDDRecorder/preparefile:s", rDoc("Init WAV file"), 0, [](const char *msg, RtData &d) {
+       Master *m = (Master*)d.obj;
+       m->HDDRecorder.preparefile(rtosc_argument(msg, 0).s, 1);}},
+    {"HDDRecorder/start:", rDoc("Start recording"), 0, [](const char *, RtData &d) {
+       Master *m = (Master*)d.obj;
+       m->HDDRecorder.start();}},
+    {"HDDRecorder/stop:", rDoc("Stop recording"), 0, [](const char *, RtData &d) {
+       Master *m = (Master*)d.obj;
+       m->HDDRecorder.stop();}},
+    {"HDDRecorder/pause:", rDoc("Pause recording"), 0, [](const char *, RtData &d) {
+       Master *m = (Master*)d.obj;
+       m->HDDRecorder.pause();}},
+
 };
 const Ports &Master::ports = master_ports;
 
diff --git a/src/UI/MasterUI.fl b/src/UI/MasterUI.fl
index c58e6d0e..d621df3f 100644
--- a/src/UI/MasterUI.fl
+++ b/src/UI/MasterUI.fl
@@ -476,7 +476,7 @@ fl_filename_setext(filename,".wav");
 
 //TODO TODO Test if a file exists
 if (fl_choice("The file *might* exist. \\nOverwrite it?","No","Yes",NULL)) {
-    osc->write("/HDDRecorder/preparefile", "T");
+    osc->write("/HDDRecorder/preparefile", "s", filename);
     recordbutton->activate();//TODO make this button osc controlled
 }
 
@@ -769,7 +769,7 @@ stopbutton->activate();
 pausebutton->activate();
 pauselabel->activate();
 o->oscWrite("HDDRecorder/start");
-o->oscWrite("resetvu");
+o->oscWrite("reset-vu");
 mastermenu->redraw();}
             tooltip {Start Recording} xywh {159 46 21 21} box ROUND_UP_BOX color 88 labelfont 1 labelsize 10 align 2 deactivate
             class Fl_Osc_Button
-- 
2.47.0

