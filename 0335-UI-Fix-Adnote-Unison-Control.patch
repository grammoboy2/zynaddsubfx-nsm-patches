From 1e3157fdaadf0db015fb1b952cd0136a1bdc4ff3 Mon Sep 17 00:00:00 2001
From: fundamental <mark.d.mccurry@gmail.com>
Date: Thu, 19 Feb 2015 22:21:17 -0500
Subject: [PATCH 0335/1936] UI: Fix Adnote Unison Control

---
 src/Params/ADnoteParameters.cpp | 1 +
 src/UI/ADnoteUI.fl              | 9 +++------
 2 files changed, 4 insertions(+), 6 deletions(-)

diff --git a/src/Params/ADnoteParameters.cpp b/src/Params/ADnoteParameters.cpp
index 3c5d2f4c..7c31bc28 100644
--- a/src/Params/ADnoteParameters.cpp
+++ b/src/Params/ADnoteParameters.cpp
@@ -56,6 +56,7 @@ static Ports voicePorts = {
 
     rToggle(Enabled, "Voice Enable"),
     rParamZyn(Unison_size, "Number of subvoices"),
+    rParamZyn(Unison_phase_randomness, "Phase Randomness"),
     rParamZyn(Unison_frequency_spread, "Subvoice detune"),
     rParamZyn(Unison_stereo_spread, "Subvoice L/R Separation"),
     rParamZyn(Unison_vibratto, "Subvoice vibratto"),
diff --git a/src/UI/ADnoteUI.fl b/src/UI/ADnoteUI.fl
index bfe159d7..ad0a083c 100644
--- a/src/UI/ADnoteUI.fl
+++ b/src/UI/ADnoteUI.fl
@@ -260,7 +260,6 @@ o->redraw();}
               }
               Fl_Value_Output fmdetunevalueoutput {
                 label Detune
-                callback {(void)o;//o->value(getdetune((pars->VoicePar[nvoice].PFMDetuneType==0)?(pars->GlobalPar.PDetuneType) : (pars->VoicePar[nvoice].PFMDetuneType),0,pars->VoicePar[nvoice].PFMDetune));}
                 xywh {540 245 45 18} labelsize 8 align 5 minimum -5000 maximum 5000 step 0.01 textfont 1 textsize 8
                 code0 {o->init("FMdetunevalue");}
                 class Fl_Osc_Output
@@ -566,10 +565,9 @@ voiceonbutton->redraw();} open
             }
             Fl_Choice {} {
               label Unison
-              callback {(void)o;//pars->set_unison_size_index(nvoice,(int) o->value());} open
               tooltip {Unison size} xywh {10 560 75 20} down_box BORDER_BOX labelfont 1 align 5 textfont 1 textsize 10
               code0 {o->add("OFF");char tmp[100];for (int i=1;ADnote_unison_sizes[i];i++){snprintf(tmp,100,"size %d",ADnote_unison_sizes[i]);o->add(tmp);};}
-              code1 {o->init("Unison_size");//pars->get_unison_size_index(nvoice));}
+              code1 {o->init("Unison_size");}
               class Fl_Osc_Choice
             } {}
             Fl_Dial {} {
@@ -606,10 +604,9 @@ voiceonbutton->redraw();} open
             }
             Fl_Dial {} {
               label {Ph.rand}
-              callback {(void)o;/*pars->VoicePar[nvoice].Unison_phase_randomness=(int)o->value();*/}
               tooltip {Phase randomness} xywh {280 555 25 25} box ROUND_UP_BOX labelsize 10 align 1 maximum 127 step 1
-              code0 {/*o->value(pars->VoicePar[nvoice].Unison_phase_randomness);*/}
-              class WidgetPDial
+              code0 {o->init("Unison_phase_randomness");}
+              class Fl_Osc_Dial
             }
           }
         }
-- 
2.47.0

