From 2ad6437e95507575e254279718a07d55927f664e Mon Sep 17 00:00:00 2001
From: "Christopher A. Oliver" <caowasteland@gmail.com>
Date: Tue, 6 Oct 2015 01:52:00 -0400
Subject: [PATCH 0569/1936] Guarantee that modulator section of advoice is
 appropriately highlighted.

---
 src/UI/ADnoteUI.fl | 23 ++++++++++++++++++-----
 1 file changed, 18 insertions(+), 5 deletions(-)

diff --git a/src/UI/ADnoteUI.fl b/src/UI/ADnoteUI.fl
index 0c461121..32e65dc4 100644
--- a/src/UI/ADnoteUI.fl
+++ b/src/UI/ADnoteUI.fl
@@ -170,9 +170,17 @@ o->redraw();}
       }
       Fl_Button {} {
         label edit
-        callback {ui->partui->adnoteui->ADnoteVoice->show();
-ui->partui->adnoteui->advoice->change_voice(nvoice);
-ui->partui->adnoteui->currentvoicecounter->value(nvoice+1);}
+        callback {
+class ADnoteUI *adnoteui = ui->partui->adnoteui;
+class ADvoiceUI *advoice = adnoteui->advoice;
+adnoteui->ADnoteVoice->show();
+advoice->change_voice(nvoice);
+adnoteui->currentvoicecounter->value(nvoice+1);
+if (advoice->mod_type->value() == 0)
+    advoice->voiceFMparametersgroup->deactivate();
+else
+    advoice->voiceFMparametersgroup->activate();
+}
         xywh {53 6 40 15} box THIN_UP_BOX labelsize 11
       }
     }
@@ -399,7 +407,7 @@ voiceFMparametersgroup->redraw();} open
               class Fl_Osc_Choice
             } {}
           }
-          Fl_Choice {} {
+          Fl_Choice mod_type {
             label {Type:}
             callback {if (o->value()==0) voiceFMparametersgroup->deactivate();
 else voiceFMparametersgroup->activate();
@@ -1047,7 +1055,12 @@ ADnoteVoiceList->show();}
       }
       Fl_Button {} {
         label {Show Voice Parameters}
-        callback {ADnoteVoice->show();}
+        callback {
+        if (advoice->mod_type->value() == 0)
+            advoice->voiceFMparametersgroup->deactivate();
+        else
+            advoice->voiceFMparametersgroup->activate();
+        ADnoteVoice->show();}
         xywh {5 400 170 25} labelsize 12
       }
       Fl_Button {} {
-- 
2.47.0

