From 6b7d58dbcc72db78052977fa066c0e2c9ad28ee0 Mon Sep 17 00:00:00 2001
From: "Christopher A. Oliver" <oliver@onion.private>
Date: Fri, 2 Oct 2015 22:58:46 -0400
Subject: [PATCH 0553/1936] Add edit buttons to ADvoice list.  Restore value
 sliders where they got lost.

---
 src/UI/ADnoteUI.fl | 66 ++++++++++++++++++++++++++++------------------
 src/UI/PartUI.fl   |  2 +-
 2 files changed, 42 insertions(+), 26 deletions(-)

diff --git a/src/UI/ADnoteUI.fl b/src/UI/ADnoteUI.fl
index fa9d8cc7..0fc5eeb3 100644
--- a/src/UI/ADnoteUI.fl
+++ b/src/UI/ADnoteUI.fl
@@ -70,12 +70,21 @@ decl {\#include "OscilGenUI.h"} {public local
 decl {\#include "PresetsUI.h"} {public local
 } 
 
+decl {\#include "PartUI.h"} {private local
+} 
+
+decl {\#include "MasterUI.h"} {private local
+} 
+
+decl {extern class MasterUI *ui;} {private local
+} 
+
 class ADvoicelistitem {open : {public Fl_Osc_Group}
 } {
   Function {make_window()} {open private
   } {
     Fl_Window ADnoteVoiceListItem {open
-      private xywh {346 881 615 100} type Double box UP_FRAME
+      private xywh {117 90 670 100} type Double box NO_BOX
       class Fl_Osc_Group visible
     } {
       Fl_Box {} {
@@ -83,50 +92,50 @@ class ADvoicelistitem {open : {public Fl_Osc_Group}
         code0 {ADnoteVoiceListItem->base = loc;}
       }
       Fl_Group voicelistitemgroup {open
-        private xywh {50 0 570 25}
+        private xywh {0 0 670 25}
         class Fl_Osc_Group
       } {
         Fl_Value_Slider voicevolume {
-          tooltip Volume xywh {90 5 115 20} type {Horz Knob} box NO_BOX labelsize 8 align 5 maximum 127 step 1
+          tooltip Volume xywh {132 5 115 20} type {Horz Knob} box NO_BOX labelsize 8 align 5 maximum 127 step 1
           code1 {o->init("PVolume");}
           class Fl_Osc_VSlider
         }
         Fl_Check_Button voiceresonanceenabled {
-          tooltip {Resonance On/Off} xywh {245 7 15 17} down_box DOWN_BOX labeltype EMBOSSED_LABEL labelfont 1 labelsize 11 align 4
+          tooltip {Resonance On/Off} xywh {287 7 15 17} down_box DOWN_BOX labeltype EMBOSSED_LABEL labelfont 1 labelsize 11 align 4
           code0 {o->init("Presonance");}
           class Fl_Osc_Check
         }
         Fl_Value_Slider voicelfofreq {
-          tooltip {Frequency LFO amount} xywh {500 5 115 20} type {Horz Knob} box NO_BOX labelsize 8 align 5 maximum 127 step 1
+          tooltip {Frequency LFO amount} xywh {542 5 115 20} type {Horz Knob} box NO_BOX labelsize 8 align 5 maximum 127 step 1
           code0 {o->init("FreqLfo/Pintensity", 'i');}
-          class Fl_Osc_Slider
+          class Fl_Osc_VSlider
         }
         Fl_Dial voicepanning {
-          tooltip {Panning (leftmost is Random)} xywh {215 5 20 20} box ROUND_UP_BOX labelsize 10 align 4 maximum 127 step 1
+          tooltip {Panning (leftmost is Random)} xywh {257 5 20 20} box ROUND_UP_BOX labelsize 10 align 4 maximum 127 step 1
           code0 {o->init("PPanning");}
           class Fl_Osc_Dial
         }
         Fl_Group voiceoscil {open
-          xywh {60 5 30 20} box THIN_DOWN_BOX color 32 selection_color 71 labelcolor 179
+          xywh {102 5 30 20} box THIN_DOWN_BOX color 32 selection_color 71 labelcolor 179
           code0 {voiceoscil->ext = "OscilSmp/";}
           code1 {oscil=new Fl_Oscilloscope(o->x(),o->y(),o->w(),o->h(),"");}
           code2 {oscil->init(false);}
           class Fl_Osc_Group
         } {}
         Fl_Value_Output detunevalueoutput {
-          xywh {265 5 45 20} labelsize 10 align 5 minimum -5000 maximum 5000 step 0.01 textfont 1 textsize 10
+          xywh {307 5 45 20} labelsize 10 align 5 minimum -5000 maximum 5000 step 0.01 textfont 1 textsize 10
           code0 {o->init("detunevalue");}
           class Fl_Osc_Output
         }
         Fl_Slider voicedetune {
           callback {detunevalueoutput->update();}
-          tooltip {Fine Detune (cents)} xywh {315 5 185 20} type {Horz Knob} box NO_BOX minimum -8192 maximum 8191 step 1
+          tooltip {Fine Detune (cents)} xywh {357 5 185 20} type {Horz Knob} box NO_BOX minimum -8192 maximum 8191 step 1
           code0 {o->init("PDetune",'i');}
           class Fl_Osc_Slider
         }
         Fl_Box whitenoiselabel {
           label N
-          xywh {65 5 20 20} labelfont 1 labelsize 13 labelcolor 7
+          xywh {107 5 20 20} labelfont 1 labelsize 13 labelcolor 7
         }
         Fl_Check_Button noisehack {
           callback {if (o->value()==0) {
@@ -159,6 +168,13 @@ o->redraw();}
         code1 {o->init("Enabled");}
         class Fl_Osc_Check
       }
+      Fl_Button {} {
+        label edit
+        callback {ui->partui->adnoteui->ADnoteVoice->show();
+ui->partui->adnoteui->advoice->change_voice(nvoice);
+ui->partui->adnoteui->currentvoicecounter->value(nvoice+1);}
+        xywh {53 6 40 15} box THIN_UP_BOX labelsize 11
+      }
     }
   }
   Function {ADvoicelistitem(int x,int y, int w, int h, const char *label=0):Fl_Osc_Group(x,y,w,h,label)} {open
@@ -281,7 +297,7 @@ o->redraw();}
                 label Vol
                 tooltip Volume xywh {540 80 160 15} type {Horz Knob} box NO_BOX labelsize 11 align 8 maximum 127 step 1
                 code0 {o->init("PFMVolume", 'i');}
-                class Fl_Osc_Slider
+                class Fl_Osc_VSlider
               }
               Fl_Value_Slider {} {
                 label {V.Sns}
@@ -309,7 +325,7 @@ o->redraw();}
                 label {F.Damp}
                 tooltip {Modulator Damp at Higher frequency} xywh {540 120 160 15} type {Horz Knob} box NO_BOX labelsize 11 align 8 minimum -64 maximum 63 step 1
                 code0 {o->init("PFMVolumeDamp",'i');}
-                class Fl_Osc_Slider
+                class Fl_Osc_VSlider
               }
             }
             Fl_Group modoscil {open
@@ -1076,7 +1092,7 @@ advoice->change_voice(nvoice);}
     }
     Fl_Window ADnoteVoiceList {
       label {ADsynth Voices list} open
-      xywh {32 266 650 260} type Double hide
+      xywh {6 263 670 260} type Double hide
       class Fl_Osc_Window
     } {
       Fl_Box {} {
@@ -1085,39 +1101,39 @@ advoice->change_voice(nvoice);}
       }
       Fl_Text_Display {} {
         label {No.}
-        xywh {10 15 30 10} box NO_BOX labelfont 1 labelsize 11
+        xywh {17 15 30 10} box NO_BOX labelfont 1 labelsize 11
       }
       Fl_Text_Display {} {
         label Vol
-        xywh {145 15 30 10} box NO_BOX labelfont 1 labelsize 11
+        xywh {190 15 30 10} box NO_BOX labelfont 1 labelsize 11
       }
       Fl_Text_Display {} {
         label Detune
-        xywh {384 15 25 10} box NO_BOX labelfont 1 labelsize 11
+        xywh {431 15 25 10} box NO_BOX labelfont 1 labelsize 11
       }
       Fl_Text_Display {} {
         label Pan
-        xywh {210 15 30 10} box NO_BOX labelfont 1 labelsize 11
+        xywh {253 15 30 10} box NO_BOX labelfont 1 labelsize 11
       }
       Fl_Text_Display {} {
-        label {Vib. Depth}
-        xywh {560 15 30 10} box NO_BOX labelfont 1 labelsize 11
+        label {Vib. Depth} selected
+        xywh {600 15 30 10} box NO_BOX labelfont 1 labelsize 11
       }
       Fl_Text_Display {} {
         label {R.}
-        xywh {245 15 25 10} box NO_BOX labelfont 1 labelsize 11
+        xywh {285 15 25 10} box NO_BOX labelfont 1 labelsize 11
       }
       Fl_Button {} {
         label {Hide Voice List}
         callback {ADnoteVoiceList->hide();}
-        xywh {255 237 125 20}
+        xywh {271 237 125 20}
       }
       Fl_Scroll {} {open
-        xywh {0 15 640 220} type VERTICAL box THIN_UP_BOX
+        xywh {0 15 670 220} type VERTICAL box THIN_UP_BOX
       } {
         Fl_Pack {} {open
-          xywh {0 20 620 210}
-          code0 {o->begin();for (int i=0;i<NUM_VOICES;i++){voicelistitem[i]=new ADvoicelistitem(0,0,620,25,"");voicelistitem[i]->init(i,loc+"VoicePar"+to_s(i)+"/",osc);}o->end();}
+          xywh {0 20 670 210}
+          code0 {o->begin();for (int i=0;i<NUM_VOICES;i++){voicelistitem[i]=new ADvoicelistitem(0,0,670,25,"");voicelistitem[i]->init(i,loc+"VoicePar"+to_s(i)+"/",osc);}o->end();}
         } {}
       }
     }
diff --git a/src/UI/PartUI.fl b/src/UI/PartUI.fl
index f045b928..46b2edce 100644
--- a/src/UI/PartUI.fl
+++ b/src/UI/PartUI.fl
@@ -1089,7 +1089,7 @@ delete(instrumenteditwindow);} {}
   }
   decl {BankUI *bankui;} {private local
   }
-  decl {ADnoteUI *adnoteui;} {private local
+  decl {ADnoteUI *adnoteui;} {selected public local
   }
   decl {SUBnoteUI *subnoteui;} {private local
   }
-- 
2.47.0

