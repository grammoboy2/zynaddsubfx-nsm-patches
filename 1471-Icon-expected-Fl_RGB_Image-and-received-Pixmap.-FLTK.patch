From 9cdabbdbdf05f0df8a3d1c1e6d3494e6c8542495 Mon Sep 17 00:00:00 2001
From: thenorili <norilinoriginal@gmail.com>
Date: Mon, 17 Feb 2020 19:04:29 -0500
Subject: [PATCH 1471/1936] Icon() expected Fl_RGB_Image and received Pixmap.
 FLTK icons work now.

---
 src/UI/MasterUI.fl | 23 +++++++++++++++++++----
 1 file changed, 19 insertions(+), 4 deletions(-)

diff --git a/src/UI/MasterUI.fl b/src/UI/MasterUI.fl
index 93dc5553..f72f513e 100644
--- a/src/UI/MasterUI.fl
+++ b/src/UI/MasterUI.fl
@@ -87,6 +87,22 @@ decl {\#if !defined(PLUGINVERSION) && HAS_X11
 \#endif} {public local
 } 
 
+decl {\#if !defined(PLUGINVERSION) && HAS_X11
+\#include <FL/Fl_RGB_Image.H>
+\#endif} {private local
+} 
+
+decl {\#if !defined(PLUGINVERSION) && HAS_X11
+\#include <FL/FL.H>
+\#include "Enumerations.H"
+\#endif} {private local
+} 
+
+decl {\#if !defined(PLUGINVERSION) && HAS_X11
+\#include <FL/Fl_Pixmap.H>
+\#endif} {private local
+} 
+
 decl {\#include "../globals.h"} {public local
 } 
 
@@ -1576,10 +1592,9 @@ make_window();
 fl_open_display();
 
 \#if !defined(PLUGINVERSION) && HAS_X11
-Pixmap p, mask;
-XCreatePixmapFromData(fl_display, DefaultRootWindow(fl_display),
-                                 (char**)zynaddsubfx_xpm, &p, &mask, NULL);
-masterwindow->icon((char *)p);
+Fl_Pixmap *pixmap = new Fl_Pixmap(zynaddsubfx_xpm);
+Fl_RGB_Image *p = new Fl_RGB_Image(pixmap, FL_GRAY);
+masterwindow->icon(p);
 \#endif
 assert(osc);
 presetsui=new PresetsUI(osc);
-- 
2.47.0

