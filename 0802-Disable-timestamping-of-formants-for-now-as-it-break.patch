From 4bd807221e885f57d05cf18937b37da0acdfd567 Mon Sep 17 00:00:00 2001
From: "Christopher A. Oliver" <caowasteland@gmail.com>
Date: Sun, 27 Dec 2015 20:57:12 -0500
Subject: [PATCH 0802/1936] Disable timestamping of formants for now as it
 breaks formant editing.

---
 src/Params/FilterParams.cpp | 14 +++++++-------
 src/Params/FilterParams.h   | 12 ++++++------
 2 files changed, 13 insertions(+), 13 deletions(-)

diff --git a/src/Params/FilterParams.cpp b/src/Params/FilterParams.cpp
index c457cecc..0374dffd 100644
--- a/src/Params/FilterParams.cpp
+++ b/src/Params/FilterParams.cpp
@@ -38,14 +38,14 @@ constexpr int sizeof_pvowels = sizeof(FilterParams::Pvowels);
 
 #define rObject FilterParams::Pvowels_t::formants_t
 
-#undef rChangeCb
-#define rChangeCb if (obj->time) { obj->last_update_timestamp = obj->time->time(); }
+//#undef rChangeCb
+//#define rChangeCb if (obj->time) { obj->last_update_timestamp = obj->time->time(); }
 static const rtosc::Ports subsubports = {
     rParamZyn(freq, "Formant frequency"),
     rParamZyn(amp,  "Strength of formant"),
     rParamZyn(q,    "Quality Factor"),
 };
-#undef rChangeCb
+//#undef rChangeCb
 #undef rObject
 
 static const rtosc::Ports subports = {
@@ -59,13 +59,13 @@ static const rtosc::Ports subports = {
             FilterParams::Pvowels_t *obj = (FilterParams::Pvowels_t *) d.obj;
             d.obj = (void*) &obj->formants[idx];
             subsubports.dispatch(msg, d);
-            if (obj->time) { obj->last_update_timestamp = obj->time->time(); }
+//            if (obj->time) { obj->last_pdate_timestamp = obj->time->time(); }
         }},
 };
 
 #define rObject FilterParams
 #undef  rChangeCb
-#define rChangeCb obj->changed = true; if ( obj->time) { \
+#define rChangeCb obj->changed = true; if ( obj->time) {      \
     obj->last_update_timestamp = obj->time->time(); }
 const rtosc::Ports FilterParams::ports = {
     rSelf(FilterParams),
@@ -189,13 +189,13 @@ void FilterParams::defaults(int n)
 {
     int j = n;
 
-    Pvowels[j].time = time;
+//    Pvowels[j].time = time;
 
     for(int i = 0; i < FF_MAX_FORMANTS; ++i) {
         Pvowels[j].formants[i].freq = (int)(RND * 127.0f); //some random freqs
         Pvowels[j].formants[i].q    = 64;
         Pvowels[j].formants[i].amp  = 127;
-        Pvowels[j].formants[i].time = time;
+//        Pvowels[j].formants[i].time = time;
     }
 }
 
diff --git a/src/Params/FilterParams.h b/src/Params/FilterParams.h
index f8b5b54c..245f6d83 100644
--- a/src/Params/FilterParams.h
+++ b/src/Params/FilterParams.h
@@ -68,17 +68,17 @@ class FilterParams:public PresetsArray
         unsigned char Pcenterfreq, Poctavesfreq; //the center frequency of the res. func., and the number of octaves
 
         struct Pvowels_t {
-            Pvowels_t() : last_update_timestamp(0) {}
+//            Pvowels_t() : last_update_timestamp(0) {}
             struct formants_t {
-                formants_t() : last_update_timestamp(0) {}
+//                formants_t() : last_update_timestamp(0) {}
                 unsigned char freq, amp, q; //frequency,amplitude,Q
 
-                const AbsTime *time;
-                int64_t last_update_timestamp;
+//                const AbsTime *time;
+//                int64_t last_update_timestamp;
             } formants[FF_MAX_FORMANTS];
 
-            const AbsTime *time;
-            int64_t last_update_timestamp;
+//            const AbsTime *time;
+//            int64_t last_update_timestamp;
         } Pvowels[FF_MAX_VOWELS];
 
 
-- 
2.47.0

