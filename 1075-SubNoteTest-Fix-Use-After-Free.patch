From 33670644bb6908301255b25a5ffa61d401484418 Mon Sep 17 00:00:00 2001
From: fundamental <mark.d.mccurry@gmail.com>
Date: Tue, 15 Nov 2016 19:34:48 -0500
Subject: [PATCH 1075/1936] SubNoteTest: Fix Use After Free

This commit only affects the testing code
---
 src/Tests/SubNoteTest.h | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/Tests/SubNoteTest.h b/src/Tests/SubNoteTest.h
index 037769c5..04a09e3d 100644
--- a/src/Tests/SubNoteTest.h
+++ b/src/Tests/SubNoteTest.h
@@ -33,6 +33,7 @@ class SubNoteTest:public CxxTest::TestSuite
 {
     public:
 
+        SUBnoteParameters *pars;
         SUBnote      *note;
         Master       *master;
         AbsTime      *time;
@@ -77,7 +78,7 @@ class SubNoteTest:public CxxTest::TestSuite
 
             SynthParams pars{memory, *controller, *synth, *time, freq, 120, 0, testnote, false};
             note = new SUBnote(defaultPreset, pars);
-            delete defaultPreset;
+            this->pars = defaultPreset;
         }
 
         void tearDown() {
@@ -87,6 +88,7 @@ class SubNoteTest:public CxxTest::TestSuite
             delete [] outR;
             delete time;
             delete synth;
+            delete pars;
         }
 
         void testDefaults() {
-- 
2.47.0

